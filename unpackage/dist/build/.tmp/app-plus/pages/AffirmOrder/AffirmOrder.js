(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/AffirmOrder/AffirmOrder"],{"0794":function(e,t,r){"use strict";var a=r("4ca7"),n=r.n(a);n.a},"430f":function(e,t,r){"use strict";var a={"u-popup":function(){return r.e("uview/components/u-popup/u-popup").then(r.bind(null,"dcee"))}},n=function(){var e=this,t=e.$createElement;e._self._c},o=[];r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return a}))},"4ca7":function(e,t,r){},"806f":function(e,t,r){"use strict";r.r(t);var a=r("430f"),n=r("cf84");for(var o in n)"default"!==o&&function(e){r.d(t,e,(function(){return n[e]}))}(o);r("0794");var i,s=r("f0c5"),u=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],i);t["default"]=u.exports},8710:function(e,t,r){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r("4795"));function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r,a,n,o,i){try{var s=e[o](i),u=s.value}catch(f){return void r(f)}s.done?t(u):Promise.resolve(u).then(a,n)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(a,n){var o=e.apply(t,r);function s(e){i(o,a,n,s,u,"next",e)}function u(e){i(o,a,n,s,u,"throw",e)}s(void 0)}))}}var u={onLoad:function(t){e.hideTabBar(),a("log",t," at pages\\AffirmOrder\\AffirmOrder.vue:89"),this.type=t.type,2==this.type?this.markeyInfo=JSON.parse(t.marketInfo):(this.queueId=t.queueId,this.initQkShopDetai()),1==t.marketFlag?this.marketFlag=1:this.marketFlag=0,this.initGetPhoneInfo(),a("log",this.markeyInfo," at pages\\AffirmOrder\\AffirmOrder.vue:107"),this.GetDefaultAddress()},onShow:function(){e.getStorageSync("chooseAddress")&&(this.AddressInfo=e.getStorageSync("chooseAddress"))},data:function(){return{AddressInfo:{id:0,userName:"",phonenumber:"",province:"",detail:""},markeyInfo:{},showPopPay:!1,payInfo:[{image:"../../static/image/ych/pay/1.png",text:"支付宝支付",sectext:""},{image:"../../static/image/ych/pay/2.png",text:"微信支付",sectext:""}],circleShowFlag:0,type:0,queueId:0,marketFlag:0}},methods:{goToMyAddress:function(){e.navigateTo({url:"../My/myAddress?flag=1"})},showPayPop:function(){var t=this;return s(n.default.mark((function r(){return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.AddressInfo.phonenumber){r.next=2;break}return r.abrupt("return",e.showToast({icon:"none",title:"请先输入地址"}));case 2:t.showPopPay=!0;case 3:case"end":return r.stop()}}),r)})))()},initGetPhoneInfo:function(){a("log",e.getSystemInfoSync()," at pages\\AffirmOrder\\AffirmOrder.vue:166"),this.platform=e.getSystemInfoSync().platform},handleCircle:function(e){a("log",e," at pages\\AffirmOrder\\AffirmOrder.vue:171"),this.circleShowFlag=e},payMoney:function(){var t=this;return s(n.default.mark((function r(){var o,i,s,u,f;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(2!=t.type){r.next=7;break}return r.next=3,t.$fetch(t.$api.addMarketOrder,{addressId:t.AddressInfo.id,goodsId:t.markeyInfo.id,ordnum:t.markeyInfo.ordnum},"GET","FORM");case 3:o=r.sent,a("log",o," at pages\\AffirmOrder\\AffirmOrder.vue:178"),r.next=11;break;case 7:return r.next=9,t.$fetch(t.$api.initQukanOrder,{addressId:t.AddressInfo.id,queueId:t.markeyInfo.queueId,ordnum:t.markeyInfo.ordnum},"GET","FORM");case 9:i=r.sent,a("log",i," at pages\\AffirmOrder\\AffirmOrder.vue:181");case 11:if(0!=t.circleShowFlag){r.next=17;break}return r.next=14,t.$fetch(t.$api.appOrderPay,{ordnum:t.markeyInfo.ordnum},"POST","FORM");case 14:s=r.sent,a("log",s," at pages\\AffirmOrder\\AffirmOrder.vue:188"),e.requestPayment({provider:"alipay",orderInfo:s.msg,success:function(r){e.showToast({icon:"none",title:"支付成功"}),e.removeStorageSync("chooseAddress"),t.showPopPay=!1,"ios"==t.platform&&t.marketFlag?setTimeout((function(){e.setStorageSync("iosFlag",!0),e.switchTab({url:"../My/My"})}),1e3):"ios"!=t.platform||t.marketFlag?setTimeout((function(){1==t.type?e.navigateTo({url:"../myOrder/myOrder?orderType=1&status=3"}):2==t.type&&e.navigateTo({url:"../myOrder/myOrder?orderType=2&status=2"})}),1e3):setTimeout((function(){e.setStorageSync("consigneeFlag",!0),e.navigateBack({delta:1})}),1e3)},fail:function(r){a("log","fail:"+JSON.stringify(r)," at pages\\AffirmOrder\\AffirmOrder.vue:229"),e.showToast({icon:"none",title:"支付失败"}),e.removeStorageSync("chooseAddress"),t.showPopPay=!1,"ios"==t.platform&&t.marketFlag?setTimeout((function(){e.setStorageSync("iosFlag",!0),e.switchTab({url:"../My/My"})}),1e3):"ios"!=t.platform||t.marketFlag?setTimeout((function(){1==t.type?e.navigateTo({url:"../myOrder/myOrder?orderType=1&status=0"}):2==t.type&&e.navigateTo({url:"../myOrder/myOrder?orderType=2&status=1"})}),1e3):setTimeout((function(){e.setStorageSync("consigneeFlag",!0),e.navigateBack({delta:1})}),1e3)}});case 17:if(1!=t.circleShowFlag){r.next=25;break}return r.next=20,t.$fetch(t.$api.wxAppPay,{ordnum:t.markeyInfo.ordnum},"POST","FORM");case 20:u=r.sent,a("log",u," at pages\\AffirmOrder\\AffirmOrder.vue:270"),a("log",JSON.parse(u.msg)," at pages\\AffirmOrder\\AffirmOrder.vue:271"),f=JSON.parse(u.msg),e.requestPayment({provider:"wxpay",orderInfo:f,success:function(r){a("log",r," at pages\\AffirmOrder\\AffirmOrder.vue:277"),e.showToast({icon:"none",title:"支付成功"}),e.removeStorageSync("chooseAddress"),t.showPopPay=!1,"ios"==t.platform&&t.marketFlag?setTimeout((function(){e.setStorageSync("iosFlag",!0),e.switchTab({url:"../My/My"})}),1e3):"ios"!=t.platform||t.marketFlag?setTimeout((function(){1==t.type?e.navigateTo({url:"../myOrder/myOrder?orderType=1&status=3"}):2==t.type&&e.navigateTo({url:"../myOrder/myOrder?orderType=2&status=2"})}),1e3):setTimeout((function(){e.setStorageSync("consigneeFlag",!0),e.navigateBack({delta:1})}),1e3)},fail:function(r){e.showToast({icon:"none",title:"支付失败"}),e.removeStorageSync("chooseAddress"),t.showPopPay=!1,"ios"==t.platform&&t.marketFlag?setTimeout((function(){e.setStorageSync("iosFlag",!0),e.switchTab({url:"../My/My"})}),1e3):"ios"!=t.platform||t.marketFlag?setTimeout((function(){1==t.type?e.navigateTo({url:"../myOrder/myOrder?orderType=1&status=0"}):2==t.type&&e.navigateTo({url:"../myOrder/myOrder?orderType=2&status=1"})}),1e3):setTimeout((function(){e.setStorageSync("consigneeFlag",!0),e.navigateBack({delta:1})}),1e3)}});case 25:case"end":return r.stop()}}),r)})))()},GetDefaultAddress:function(){var e=this;return s(n.default.mark((function t(){var r;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$fetch(e.$api.getDefaultAddress,{},"GET","FORM");case 2:r=t.sent,a("log",r," at pages\\AffirmOrder\\AffirmOrder.vue:356"),r.data.id&&(e.AddressInfo=r.data);case 5:case"end":return t.stop()}}),t)})))()},initQkShopDetai:function(){var e=this;return s(n.default.mark((function t(){var r;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$fetch(e.$api.buyQukanGoods,{queueId:e.queueId},"GET","FORM");case 2:r=t.sent,a("log",r," at pages\\AffirmOrder\\AffirmOrder.vue:365"),e.markeyInfo=r.data;case 5:case"end":return t.stop()}}),t)})))()}}};t.default=u}).call(this,r("6e42")["default"],r("0de9")["default"])},cf84:function(e,t,r){"use strict";r.r(t);var a=r("8710"),n=r.n(a);for(var o in a)"default"!==o&&function(e){r.d(t,e,(function(){return a[e]}))}(o);t["default"]=n.a},dc07:function(e,t,r){"use strict";(function(e){r("fad5"),r("921b");a(r("66fd"));var t=a(r("806f"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,r("6e42")["createPage"])}},[["dc07","common/runtime","common/vendor"]]]);