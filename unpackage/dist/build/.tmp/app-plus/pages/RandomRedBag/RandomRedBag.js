(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/RandomRedBag/RandomRedBag"],{"181f":function(t,e,a){"use strict";var n=a("5399"),o=a.n(n);o.a},5399:function(t,e,a){},"5c3b":function(t,e,a){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o,i=u(a("4795"));function u(t){return t&&t.__esModule?t:{default:t}}function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function s(t,e,a,n,o,i,u){try{var r=t[i](u),s=r.value}catch(c){return void a(c)}r.done?e(s):Promise.resolve(s).then(n,o)}function c(t){return function(){var e=this,a=arguments;return new Promise((function(n,o){var i=t.apply(e,a);function u(t){s(i,n,o,u,r,"next",t)}function r(t){s(i,n,o,u,r,"throw",t)}u(void 0)}))}}var d=(o={onLoad:function(){this.initInviteInfo()},onShow:function(){},data:function(){return{bgImg:"../../static/image/ych/else/hongbao3.png",copyPop:!1,shareGroupBg:"../../static/image/ych/else/sharegroup.png",groupFlag:!1,shareSuccess:!1,shareStatus:0,shareCount:0,shareMsg:!1,activityId:null,amount:0,totalPoints:0,minNum:0,friends:null,friendsMax:1,groupsMax:2,progress:"",countdown:null,h:"00",i:"00",s:"00",helpList:[],autoplayFlag:!1,tiQuFlag:!0}},methods:{goToAtricle:function(e){t.navigateTo({url:"../article/article?id="+e})},hanleToWechatShare:function(){this.shareCount<2?0==this.shareStatus?this.copyPop=!0:this.shareStatus>=1&&this.shareStatus<=2&&(this.groupFlag=!0):(n("log","111"," at pages\\RandomRedBag\\RandomRedBag.vue:177"),this.copyPop=!0)},handleCopyPopShow:function(){this.groupFlag=!this.groupFlag},copyToShare:function(){var e=this;return c(i.default.mark((function a(){var o,u;return i.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o=!1,a.next=3,e.$fetch(e.$api.getActivityCode,{id:e.activityId},"GET");case 3:u=a.sent,t.setClipboardData({data:u.msg,success:function(){var t=c(i.default.mark((function t(a){var u,r,s,c;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("Android"!=plus.os.name){t.next=30;break}if(plus.runtime.launchApplication({pname:"com.tencent.mm"},(function(t){o=!0})),o){t.next=28;break}if(n("log","分享成功！"," at pages\\RandomRedBag\\RandomRedBag.vue:197"),0!=e.shareStatus){t.next=17;break}return t.next=7,e.$fetch(e.$api.doShare,{id:e.activityId,type:1},"GET");case 7:u=t.sent,n("log",u," at pages\\RandomRedBag\\RandomRedBag.vue:201"),e.initInviteInfo(),e.friends++,e.shareSuccess=!0,e.copyPop=!1,e.shareStatus=2,e.amount=u.data.amount,t.next=28;break;case 17:if(!(e.shareStatus>=1&&e.shareStatus<=2)){t.next=27;break}return t.next=20,e.$fetch(e.$api.doShare,{id:e.activityId,type:2},"GET");case 20:r=t.sent,e.initInviteInfo(),n("log",r," at pages\\RandomRedBag\\RandomRedBag.vue:212"),e.shareCount++,e.shareCount>=2?(e.groupFlag=!1,e.copyPop=!1,e.shareMsg=!0,e.amount=r.data.amount):(e.groupFlag=!0,e.copyPop=!1),t.next=28;break;case 27:3==e.shareStatus&&(e.groupFlag=!1,e.copyPop=!1,e.shareMsg=!0);case 28:t.next=58;break;case 30:if("iOS"!=plus.os.name){t.next=58;break}if(plus.runtime.launchApplication({action:"weixin://RnUbAwvEilb1rU9g9yBU"},(function(t){o=!0})),o){t.next=58;break}if(n("log","分享成功！"," at pages\\RandomRedBag\\RandomRedBag.vue:236"),0!=e.shareStatus){t.next=47;break}return t.next=37,e.$fetch(e.$api.doShare,{id:e.activityId,type:1},"GET");case 37:s=t.sent,e.initInviteInfo(),n("log",s," at pages\\RandomRedBag\\RandomRedBag.vue:240"),e.friends++,e.shareSuccess=!0,e.copyPop=!1,e.shareStatus=1,e.amount=s.data.amount,t.next=58;break;case 47:if(!(e.shareStatus>=1&&e.shareStatus<=2)){t.next=57;break}return t.next=50,e.$fetch(e.$api.doShare,{id:e.activityId,type:2},"GET");case 50:c=t.sent,e.initInviteInfo(),n("log",c," at pages\\RandomRedBag\\RandomRedBag.vue:249"),e.shareCount++,e.shareCount>=2?(e.groupFlag=!1,e.copyPop=!1,e.shareMsg=!0,e.amount=c.data.amount):(e.groupFlag=!0,e.copyPop=!1),t.next=58;break;case 57:3==e.shareStatus&&(e.groupFlag=!1,e.copyPop=!1,e.shareMsg=!0);case 58:case"end":return t.stop()}}),t)})));function a(e){return t.apply(this,arguments)}return a}()});case 5:case"end":return a.stop()}}),a)})))()},showCopyPop:function(){this.groupFlag=!1,this.copyPop=!this.copyPop},hanleShowGroup:function(){this.shareSuccess=!1,this.groupFlag=!0},hanleCloseSuccess:function(){this.shareSuccess=!1},goBack:function(){t.navigateBack({delta:1})},initInviteInfo:function(){var t=this;return c(i.default.mark((function e(){var a,o,u,r;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$fetch(t.$api.getActivity,{},"GET","FORM");case 2:a=e.sent,n("log",a," at pages\\RandomRedBag\\RandomRedBag.vue:292"),t.activityId=a.data.activity.id,t.amount=a.data.activity.amount,t.totalPoints=a.data.sum,t.minNum=a.data.min,t.friends=a.data.activity.friends,t.shareCount=a.data.activity.groups-1,t.shareStatus=a.data.activity.groups,t.helpList=a.data.help,t.helpList.length>2&&t.helpList.splice(3,t.helpList.length),o=t.$dayjs(),u=t.$dayjs(a.data.endTime),r=u.diff(o,"second"),t.doLoop(r);case 17:case"end":return e.stop()}}),e)})))()},endOfTime:function(){clearInterval(this.countdown),this.countdown=null},doLoop:function(t){var e=this;this.countDown(t),this.countdown=setInterval((function(){t--,t<0?e.endOfTime():e.countDown(t)}),1e3)},countDown:function(t){var e=0,a=0,n=0;t>0?(e=Math.floor(t/3600),a=Math.floor(t/60)-60*e,n=Math.floor(t)-60*e*60-60*a):this.endOfTime(),e=e<10?"0"+e:e,a=a<10?"0"+a:a,n=n<10?"0"+n:n,this.h=e,this.i=a,this.s=n},getQD:function(){var e=this;return c(i.default.mark((function a(){return i.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.tiQuFlag){a.next=2;break}return a.abrupt("return",t.showToast({icon:"none",title:"请先获取趣豆后再提取哦"}));case 2:if(!(e.amount<=0)){a.next=4;break}return a.abrupt("return",t.showToast({icon:"none",title:"请先获取趣豆后再提取哦"}));case 4:t.showModal({title:"提示",content:"请确认是否领取",success:function(){var a=c(i.default.mark((function a(o){var u;return i.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!o.confirm){a.next=9;break}return a.next=3,e.$fetch(e.$api.getActivityAward,{id:e.activityId},"GET","FORM");case 3:u=a.sent,n("log",u," at pages\\RandomRedBag\\RandomRedBag.vue:360"),t.showToast({icon:"none",title:u.msg}),0==u.code&&(e.tiQuFlag=!1,setTimeout((function(){e.autoplayFlag=!0,e.$refs.uCountTo.start(),e.tiQuFlag=!0}),700)),a.next=10;break;case 9:o.cancel&&n("log","用户点击取消"," at pages\\RandomRedBag\\RandomRedBag.vue:375");case 10:case"end":return a.stop()}}),a)})));function o(t){return a.apply(this,arguments)}return o}()});case 5:case"end":return a.stop()}}),a)})))()}}},r(o,"onShow",(function(){this.shareMsg&&(this.shareMsg=!1,t.showToast({icon:"none",title:"分享成功！不要忘了通知朋友查看微信哦！"}))})),r(o,"onUnload",(function(){this.endOfTime()})),o);e.default=d}).call(this,a("6e42")["default"],a("0de9")["default"])},7499:function(t,e,a){"use strict";a.r(e);var n=a("e18a"),o=a("b8a1");for(var i in o)"default"!==i&&function(t){a.d(e,t,(function(){return o[t]}))}(i);a("181f");var u,r=a("f0c5"),s=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],u);e["default"]=s.exports},b8a1:function(t,e,a){"use strict";a.r(e);var n=a("5c3b"),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=o.a},cf37:function(t,e,a){"use strict";(function(t){a("fad5"),a("921b");n(a("66fd"));var e=n(a("7499"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("6e42")["createPage"])},e18a:function(t,e,a){"use strict";var n={"u-count-to":function(){return a.e("uview/components/u-count-to/u-count-to").then(a.bind(null,"9a48"))},"u-popup":function(){return a.e("uview/components/u-popup/u-popup").then(a.bind(null,"dcee"))}},o=function(){var t=this,e=t.$createElement;t._self._c},i=[];a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return n}))}},[["cf37","common/runtime","common/vendor"]]]);