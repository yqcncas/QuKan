(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myOrder/myOrder"],{1896:function(e,t,r){},"2c11":function(e,t,r){"use strict";var n={"uni-load-more":function(){return r.e("components/uni-load-more/uni-load-more").then(r.bind(null,"4709"))},"u-empty":function(){return Promise.all([r.e("common/vendor"),r.e("uview/components/u-empty/u-empty")]).then(r.bind(null,"f4ef"))},"u-popup":function(){return r.e("uview/components/u-popup/u-popup").then(r.bind(null,"dcee"))}},a=function(){var e=this,t=e.$createElement;e._self._c},s=[];r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return n}))},3204:function(e,t,r){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(r("4795"));function s(e){return e&&e.__esModule?e:{default:e}}function i(e){return d(e)||c(e)||u(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){if(e){if("string"===typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function c(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function d(e){if(Array.isArray(e))return l(e)}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t,r,n,a,s,i){try{var o=e[s](i),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,a)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var s=e.apply(t,r);function i(e){p(s,n,a,i,o,"next",e)}function o(e){p(s,n,a,i,o,"throw",e)}i(void 0)}))}}var y,m=0,g=!1,h={onShow:function(){e.getStorageSync("cancelFlag")&&(this.MyOrderArr.splice(e.getStorageSync("cancelFlag"),1),e.removeStorageSync("cancelFlag")),e.getStorageSync("evaFlag")&&(this.MyOrderArr[e.getStorageSync("evaFlag")].status=4,e.removeStorageSync("cancelFlag")),e.getStorageSync("paySuccess")&&(this.MyOrderArr[e.getStorageSync("paySuccess")].status=2,this.pageNum=0,this.hasFlag=!0,this.MyOrderArr=[],this.initMyOrderList(),e.removeStorageSync("paySuccess")),e.getStorageSync("consigneeFlag")&&(this.pageNum=0,this.hasFlag=!0,this.MyOrderArr=[],this.initMyOrderList(),e.removeStorageSync("consigneeFlag")),e.getStorageSync("evaFlagRef")&&(this.pageNum=0,this.hasFlag=!0,this.MyOrderArr=[],this.initMyOrderList(),e.removeStorageSync("evaFlagRef"))},onBackPress:function(t){n("log",t," at pages\\myOrder\\myOrder.vue:160"),e.switchTab({url:"../My/My"})},data:function(){return{orderType:0,tabList:[{id:0,name:"待付款"},{id:1,name:"正在砍"},{id:2,name:"未砍中"},{id:3,name:"已砍中"}],tabCurrentIndex:0,scrollLeft:0,isEmpty:!1,hasFlag:!0,pageNum:0,pageSize:10,type:1,MyOrderArr:[],showPayPopFlag:!1,circleShowFlag:0,status:0,payInfo:[{image:"../../static/image/ych/pay/1.png",text:"支付宝支付",sectext:""},{image:"../../static/image/ych/pay/2.png",text:"微信支付",sectext:""}],orderNum:null,orderIndex:null}},methods:{changeType:function(e,t){e!=this.orderType&&(this.orderType=e,this.MyOrderArr=[],this.tabCurrentIndex=t||0,this.status=0,this.hasFlag=!0,this.pageNum=0,1==e?(this.tabList=[{id:0,name:"待付款"},{id:1,name:"正在砍"},{id:2,name:"未砍中"},{id:3,name:"已砍中"}],this.status=0,this.hasFlag=!0,this.pageNum=0,this.type=1,this.MyOrderArr=[],this.initMyOrderList()):(this.tabList=[{id:0,name:"全部订单"},{id:1,name:"待付款"},{id:2,name:"待发货"},{id:3,name:"待收货"},{id:4,name:"已完成"}],this.status=0,this.hasFlag=!0,this.pageNum=0,this.type=2,this.MyOrderArr=[],this.initMyOrderList()))},changeTab:function(e,t){var r=this;return f(a.default.mark((function t(){var s,i,o,u,c;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(g&&(clearTimeout(g),g=!1),s=e,"object"===typeof e&&(s=e.detail.current),"object"===typeof y){t.next=7;break}return t.next=6,r.getElSize("nav-bar");case 6:y=t.sent;case 7:y.scrollLeft,i=0,o=0,u=0;case 11:if(!(u<=s)){t.next=20;break}return t.next=14,r.getElSize("tab"+u);case 14:c=t.sent,i+=c.width,u===s&&(o=c.width);case 17:u++,t.next=11;break;case 20:r.hasFlag=!0,r.pageNum=0,r.MyOrderArr=[],"number"===typeof e&&(r.tabCurrentIndex=s),g=setTimeout((function(){i-o/2>m/2?(r.scrollLeft=i-o/2-m/2,n("log",r.scrollLeft," at pages\\myOrder\\myOrder.vue:273")):r.scrollLeft=0,"object"===typeof e&&(r.tabCurrentIndex=s),r.tabCurrentIndex=s,r.status=s,r.initMyOrderList()}),300);case 25:case"end":return t.stop()}}),t)})))()},getElSize:function(t){return new Promise((function(r,n){var a=e.createSelectorQuery().select("#"+t);a.fields({size:!0,scrollOffset:!0,rect:!0},(function(e){r(e)})).exec()}))},handleOpenOrderDetail:function(t,r,n,s){var i=this;return f(a.default.mark((function o(){var u;return a.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(2!=s){a.next=4;break}e.navigateTo({url:"./orderDetail?ordnum="+t+"&index="+r+"&queueId="+n+"&type="+s}),a.next=13;break;case 4:if(0!=i.status){a.next=11;break}return a.next=7,i.$fetch(i.$api.buyQukanGoods,{queueId:n},"GET","FORM");case 7:if(u=a.sent,500!=u.code){a.next=10;break}return a.abrupt("return",e.showToast({icon:"none",title:u.msg}));case 10:e.navigateTo({url:"../AffirmOrder/AffirmOrder?queueId="+n+"&type=1"});case 11:3==i.status&&e.navigateTo({url:"./orderDetail?ordnum="+t+"&index="+r+"&queueId="+n+"&type="+s}),1==i.status&&e.navigateTo({url:"../QuKan/QuKan?id="+n});case 13:case"end":return a.stop()}}),o)})))()},initMyOrderList:function(){var e=this;return f(a.default.mark((function t(){var r,s;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!=e.type){t.next=11;break}if(e.hasFlag){t.next=3;break}return t.abrupt("return");case 3:return e.pageNum=++e.pageNum,t.next=6,e.$fetch(e.$api.getQukanOrderList,{pageNum:e.pageNum,pageSize:e.pageSize,type:e.status+1},"GET","FORM");case 6:r=t.sent,n("log",r," at pages\\myOrder\\myOrder.vue:341"),e.MyOrderArr=[].concat(i(e.MyOrderArr),i(r.rows)),0==r.total?e.isEmpty=!0:e.isEmpty=!1,e.hasFlag=10*e.pageNum<r.total;case 11:if(2!=e.type){t.next=22;break}if(e.hasFlag){t.next=14;break}return t.abrupt("return");case 14:return e.pageNum=++e.pageNum,t.next=17,e.$fetch(e.$api.getOrderList,{pageNum:e.pageNum,pageSize:e.pageSize,status:e.status,type:e.type},"GET","FORM");case 17:s=t.sent,n("log",s," at pages\\myOrder\\myOrder.vue:356"),e.MyOrderArr=[].concat(i(e.MyOrderArr),i(s.rows)),0==s.total?e.isEmpty=!0:e.isEmpty=!1,e.hasFlag=10*e.pageNum<s.total;case 22:case"end":return t.stop()}}),t)})))()},showPayPop:function(e,t){this.showPayPopFlag=!0,this.orderNum=e,this.orderIndex=t},handleCircle:function(e){this.circleShowFlag=e},payMoney:function(){var t=this;return f(a.default.mark((function r(){var s,i;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(0!=t.circleShowFlag){r.next=5;break}return r.next=3,t.$fetch(t.$api.appOrderPay,{ordnum:t.orderNum},"POST","FORM");case 3:s=r.sent,e.requestPayment({provider:"alipay",orderInfo:s.msg,success:function(r){n("log","success:"+JSON.stringify(r)," at pages\\myOrder\\myOrder.vue:386"),e.showToast({icon:"none",title:"支付成功"}),t.showPayPopFlag=!1,1==t.type?t.MyOrderArr[t.orderIndex].status=1:2==t.type&&1==t.tabCurrentIndex?t.MyOrderArr.splice(t.orderIndex,1):2==t.type&&0==t.tabCurrentIndex&&(t.MyOrderArr[t.orderIndex].status=1)},fail:function(t){e.showToast({icon:"none",title:"支付失败"})}});case 5:if(1!=t.circleShowFlag){r.next=11;break}return r.next=8,t.$fetch(t.$api.wxAppPay,{ordnum:t.orderNum},"POST","FORM");case 8:i=r.sent,n("log",i," at pages\\myOrder\\myOrder.vue:412"),e.requestPayment({provider:"wxpay",timeStamp:i.timestamp,nonceStr:i.noncestr,package:i.package,signType:"MD5",paySign:i.sign,success:function(r){n("log","success:"+JSON.stringify(r)," at pages\\myOrder\\myOrder.vue:422"),e.showToast({icon:"none",title:"支付成功"}),t.showPayPopFlag=!1,1==t.type?t.MyOrderArr[t.orderIndex].status=1:2==t.type&&1==t.tabCurrentIndex?t.MyOrderArr.splice(t.orderIndex,1):2==t.type&&0==t.tabCurrentIndex&&(t.MyOrderArr[t.orderIndex].status=1)},fail:function(t){e.showToast({icon:"none",title:"支付失败"})}});case 11:case"end":return r.stop()}}),r)})))()},cancelOrder:function(t,r){var s=this;return f(a.default.mark((function i(){return a.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:n("log",r," at pages\\myOrder\\myOrder.vue:450"),e.showModal({title:"提示",content:"确定取消该订单么",success:function(){var i=f(a.default.mark((function i(o){var u;return a.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!o.confirm){a.next=8;break}return a.next=3,s.$fetch(s.$api.delMarketOrder,{ordnum:t},"GET","FORM");case 3:u=a.sent,n("log",u," at pages\\myOrder\\myOrder.vue:460"),0==u.code?(e.showToast({icon:"success",title:u.msg}),s.MyOrderArr.splice(r,1)):e.showToast({icon:"none",title:u.msg}),a.next=9;break;case 8:o.cancel&&n("log","用户点击取消"," at pages\\myOrder\\myOrder.vue:474");case 9:case"end":return a.stop()}}),i)})));function o(e){return i.apply(this,arguments)}return o}()});case 2:case"end":return i.stop()}}),i)})))()},lower:function(){this.initMyOrderList()},consignee:function(t,r){var s=this;return f(a.default.mark((function i(){return a.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:e.showModal({title:"提示",content:"是否确认收货",success:function(){var i=f(a.default.mark((function i(o){var u;return a.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!o.confirm){a.next=15;break}if(1!=s.type){a.next=8;break}return a.next=4,s.$fetch(s.$api.commitOrderQukan,{ordnum:t},"GET","FORM");case 4:u=a.sent,0==u.code?(e.showToast({icon:"success",title:"操作成功"}),s.MyOrderArr[r].status=3):e.showToast({icon:"none",title:u.msg}),a.next=12;break;case 8:return a.next=10,s.$fetch(s.$api.commitOrderMarket,{ordnum:t},"GET","FORM");case 10:u=a.sent,0==u.code?(e.showToast({icon:"success",title:"操作成功"}),s.MyOrderArr.splice(r,1)):e.showToast({icon:"none",title:u.msg});case 12:n("log",u," at pages\\myOrder\\myOrder.vue:521"),a.next=16;break;case 15:o.cancel&&n("log","用户点击取消"," at pages\\myOrder\\myOrder.vue:523");case 16:case"end":return a.stop()}}),i)})));function o(e){return i.apply(this,arguments)}return o}()});case 1:case"end":return i.stop()}}),i)})))()},goToEva:function(t,r){n("log",t," at pages\\myOrder\\myOrder.vue:531"),e.navigateTo({url:"./evaluate?id="+t+"&index="+r})}},onLoad:function(t){m=e.getSystemInfoSync().windowWidth,n("log",t," at pages\\myOrder\\myOrder.vue:541"),this.changeType(t.orderType,t.status)}};t.default=h}).call(this,r("6e42")["default"],r("0de9")["default"])},"76e9":function(e,t,r){"use strict";r.r(t);var n=r("3204"),a=r.n(n);for(var s in n)"default"!==s&&function(e){r.d(t,e,(function(){return n[e]}))}(s);t["default"]=a.a},"8e5b":function(e,t,r){"use strict";r.r(t);var n=r("2c11"),a=r("76e9");for(var s in a)"default"!==s&&function(e){r.d(t,e,(function(){return a[e]}))}(s);r("94b3");var i,o=r("f0c5"),u=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],i);t["default"]=u.exports},"94b3":function(e,t,r){"use strict";var n=r("1896"),a=r.n(n);a.a},c100:function(e,t,r){"use strict";(function(e){r("fad5"),r("921b");n(r("66fd"));var t=n(r("8e5b"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,r("6e42")["createPage"])}},[["c100","common/runtime","common/vendor"]]]);